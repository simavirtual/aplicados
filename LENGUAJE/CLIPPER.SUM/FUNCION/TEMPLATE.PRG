*** PROGRAMA TEMPIGVAR.PRG
***
clear

arq=space(11)
@ 1,1 say "Nome do arquivo...: " get arq
read

POS=RAT(".",ARQ)
   IF POS=0
     ARQ=TRIM(ARQ)+".DBF"
   ENDIF
   IF .NOT. FILE("&arq")
     @ 23,10 SAY "ARQUIVO INEXIXTENTE..."
     INKEY(0)
     RETURN
   ENDIF

USE &ARQ
SET CONSOLE OFF
SET ALTERNATE TO TEMPIGVA.TXT
SET ALTERNATE ON
A=FCOUNT()
? "**** IGUALA VARIAVEIS COM CAMPOS (VERSAO 1) ARQ. PARAMETROS"
?
FOR I = 1 TO A
  IF TYPE(FIELD(I))<>"M"
    NOMECAMPO=FIELD(I)
    NOMEVAR="M"+NOMECAMPO
  ? "&NOMEVAR. = ",&NOMECAMPO
   ENDIF
NEXT
? REPLICATE("*",70)

? "**** IGUALA VARIAVEIS COM CAMPOS (VERSAO 2)"
?
FOR I = 1 TO A
  IF TYPE(FIELD(I))<>"M"
    NOMECAMPO=FIELD(I)
    NOMEVAR="M"+NOMECAMPO
  ? "&NOMEVAR. = ",NOMECAMPO
   ENDIF
NEXT
? REPLICATE("*",70)
?
? "***** INICIALIZA VARIAVEIS COM O MESMO TIPO E TAM. DO CAMPO"

FOR I = 1 TO A 
  IF TYPE(FIELD(I))<>"M" 
    NOMECAMPO=FIELD(I)
   NOMEVAR="M"+NOMECAMPO 
   ENDIF
DO CASE
CASE TYPE(FIELD(I))="C"
? "&NOMEVAR. = SPACE(",STR( LEN(&NOMECAMPO),3 )+")" 
CASE TYPE(FIELD(I))="N" 
? "&NOMEVAR. = 0" 
CASE TYPE(FIELD(I))="D" 
? [&NOMEVAR=CTOD("")]
CASE TYPE(FIELD(I))="L" 
? "&NOMEVAR. =.F." 
ENDCASE 
NEXT
? REPLICATE("*",70)
?
?
? "*****CRIACAO DE REPLACE PARA CADA CAMPO"
FOR I=1 TO A
 IF TYPE(FIELD(I))<>"M"
  NOMECAMPO=FIELD(I)
  NOMEVAR="M"+NOMECAMPO
  ? "REPLACE &NOMECAMPO. WITH &NOMEVAR." 
  ENDIF
NEXT
? REPLICATE("*",70)

SET ALTE TO
USE
SET CONSOLE ON
CLEAR
A=MEMOEDIT(MEMOREAD("TEMPIGVA.TXT"),1,1,20,70)



