*       *********************************************************
*       *                                                         
*       * 05/05/94            PRTSETUP.SPR               13:58:13 
*       *                                                         
*       *********************************************************
*       *                                                         
*       * Walter J. Kennamer                                      
*       *                                                         
*       * Copyright (c) 1994 Microsoft Corp.                      
*       * One Microsoft Way                                       
*       * Redmond, WA  98027                                      
*       *                                                         
*       * Description:                                            
*       * This program was automatically generated by GENSCRN.    
*       *                                                         
*       *********************************************************

DO CASE
CASE _DOS OR _UNIX      && no UNIX records in screen

	
	#REGION 0
	REGIONAL m.currarea, m.talkstat, m.compstat
	
	IF SET("TALK") = "ON"
		SET TALK OFF
		m.talkstat = "ON"
	ELSE
		m.talkstat = "OFF"
	ENDIF
	m.compstat = SET("COMPATIBLE")
	SET COMPATIBLE FOXPLUS
	
	*       *********************************************************
	*       *                                                         
	*       *                MS-DOS Window definitions                
	*       *                                                         
	*       *********************************************************
	*
	
	IF NOT WEXIST("_qpr0txypw")
		DEFINE WINDOW _qpr0txypw ;
			FROM INT((SROW()-19)/2),INT((SCOL()-72)/2) ;
			TO INT((SROW()-19)/2)+18,INT((SCOL()-72)/2)+71 ;
			TITLE " Destino de impresi¢n " ;
			FLOAT ;
			NOCLOSE ;
			SHADOW ;
			NOMINIMIZE ;
			DOUBLE ;
			COLOR SCHEME 5
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *         PRTSETUP/MS-DOS Setup Code - SECTION 2          
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	
	skipvar = .T.
	pfilname = SPACE(67)
	
	pdest = SET('PRINTER',1)
	IF ":" $ pdest
	   pdest = LEFT(pdest,AT(':',pdest)-1)
	ENDIF
	IF !INLIST(pdest,'PRN','LPT1','LPT2','LPT3','COM1','COM2','COM3')
	   pfilname = PADR(pdest,67)
	   pdest = 'Archivo'
	ENDIF
	origdest = pdest
	prt_infile =pfilname
	
	IF SET('PRINT') = 'ON'
	   prtstat = 1
	ELSE
	   prtstat = 2
	ENDIF
	origprtstat = prtstat
	
	pdrivstup = IIF(LEN(_PDRIVER)=0,0,1)
	
	
	*       *********************************************************
	*       *                                                         
	*       *              PRTSETUP/MS-DOS Screen Layout              
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	IF WVISIBLE("_qpr0txypw")
		ACTIVATE WINDOW _qpr0txypw SAME
	ELSE
		ACTIVATE WINDOW _qpr0txypw NOSHOW
	ENDIF
	@ 1,2 TO 13,53
	@ 2,19 GET pdest ;
		PICTURE "@^ File;PRN;LPT1;LPT2;LPT3;COM1;COM2;COM3" ;
		SIZE 3,16 ;
		DEFAULT "LPT1" ;
		VALID _qpr0ty00p() ;
		COLOR SCHEME 5, 6
	@ 5,5 GET flist ;
		PICTURE "@*HN A\<rchivo..." ;
		SIZE 1,12,1 ;
		DEFAULT 1 ;
		VALID _qpr0ty05i()
	@ 7,4 GET pfilname ;
		SIZE 1,35 ;
		DEFAULT " " ;
		PICTURE "@3S67" ;
		VALID _qpr0ty0c4()
	@ 10,4 GET prtstat ;
		PICTURE "@*RVN Impresora activa;Impresora inactiva" ;
		SIZE 1,22,0 ;
		DEFAULT 2
	@ 10,47 GET _LMARGIN ;
		SIZE 1,2 ;
		DEFAULT " " ;
		PICTURE "@3 999" ;
		VALID _qpr0ty0d6()
	@ 11,47 GET _RMARGIN ;
		SIZE 1,2 ;
		DEFAULT " " ;
		PICTURE "@3 999" ;
		VALID _qpr0ty0hp()
	@ 6,56 GET OKbut ;
		PICTURE "@*HT \! Aceptar " ;
		SIZE 1,12,6 ;
		DEFAULT 1
	@ 8,56 GET CancBut ;
		PICTURE "@*HT \? Cancelar " ;
		SIZE 1,12,1 ;
		DEFAULT 1
	@ 14,4 GET pdrivstup ;
		PICTURE "@*C C\<onfiguraci¢n del controlador de impresora..." ;
		SIZE 1,49 ;
		DEFAULT 0 ;
		VALID _qpr0ty0mx() ;
		DISABLE
	@ 1,6 SAY "Configurar impresi¢n:" ;
		SIZE 1,21, 0
	@ 3,6 SAY "Imprimir en:" ;
		SIZE 1,12, 0
	@ 10,29 SAY "Margen izquierdo:" ;
		SIZE 1,17, 0
	@ 11,29 SAY "Margen derecho:" ;
		SIZE 1,15, 0
	
	IF NOT WVISIBLE("_qpr0txypw")
		ACTIVATE WINDOW _qpr0txypw
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *    MS-DOSREAD contains clauses from SCREEN prtsetup     
	*       *                                                         
	*       *********************************************************
	*
	
	READ CYCLE ;
		DEACTIVATE _qpr0ty0sn() ;
		SHOW _qpr0ty0sr() ;
		MODAL
	
	RELEASE WINDOW _qpr0txypw
	
	#REGION 0
	IF m.talkstat = "ON"
		SET TALK ON
	ENDIF
	IF m.compstat = "ON"
		SET COMPATIBLE ON
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *              PRTSETUP/MS-DOS Cleanup Code               
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	DO CASE
	CASE okbut = 1
	   SET PRINTER TO
	
	   IF prtstat = 1
	      SET PRINT ON
	   ELSE
	      SET PRINT OFF
	   ENDIF
	
	   pdest = ALLTRIM(UPPER(pdest))
	   DO CASE
	   CASE pdest = 'ARCHIVO'
	      IF !EMPTY(pfilname)
	         SET PRINTER TO (pfilname)
	      ELSE
	         SET PRINTER TO
	      ENDIF
	   OTHERWISE
	      pfilname = ''
	      SET PRINTER TO &pdest
	   ENDCASE
	CASE cancbut = 1
	   IF origprtstat = 1
	      SET PRINT ON
	   ELSE
	      SET PRINT OFF
	   ENDIF
	   pdest = origdest
	   pfilname = prt_infile
	ENDCASE
	skipvar = .F.
	

CASE _MAC

	
	#REGION 0
	REGIONAL m.currarea, m.talkstat, m.compstat
	
	IF SET("TALK") = "ON"
		SET TALK OFF
		m.talkstat = "ON"
	ELSE
		m.talkstat = "OFF"
	ENDIF
	m.compstat = SET("COMPATIBLE")
	SET COMPATIBLE FOXPLUS
	
	m.rborder = SET("READBORDER")
	SET READBORDER ON
	
	*       *********************************************************
	*       *                                                         
	*       *              Macintosh Window definitions               
	*       *                                                         
	*       *********************************************************
	*
	
	IF NOT WEXIST("_qpr0ty1be")
		DEFINE WINDOW _qpr0ty1be ;
			AT  0.000, 0.000  ;
			SIZE 17.000,57.000 ;
			TITLE "Printing Destination" ;
			FONT "Geneva", 10 ;
			FLOAT ;
			NOCLOSE ;
			SHADOW ;
			DOUBLE
		MOVE WINDOW _qpr0ty1be CENTER
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *        PRTSETUP/Macintosh Setup Code - SECTION 2        
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	
	skipvar = .T.
	pfilname = SPACE(67)
	
	pdest = SET('PRINTER',1)
	IF ":" $ pdest
	   pdest = LEFT(pdest,AT(':',pdest)-1)
	ENDIF
	IF !INLIST(pdest,'PRN','LPT1','LPT2','LPT3','COM1','COM2','COM3')
	   pfilname = PADR(pdest,67)
	   pdest = 'File'
	ENDIF
	origdest = pdest
	prt_infile =pfilname
	
	IF SET('PRINT') = 'ON'
	   prtstat = 1
	ELSE
	   prtstat = 2
	ENDIF
	origprtstat = prtstat
	
	pdrivstup = IIF(LEN(_PDRIVER)=0,0,1)
	
	
	*       *********************************************************
	*       *                                                         
	*       *            PRTSETUP/Macintosh Screen Layout             
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	IF WVISIBLE("_qpr0ty1be")
		ACTIVATE WINDOW _qpr0ty1be SAME
	ELSE
		ACTIVATE WINDOW _qpr0ty1be NOSHOW
	ENDIF
	@ 2.769,2.500 TO 16.461,40.667 ;
		PEN 1, 8
	@ 3.538,9.000 SAY "Print to:" ;
		FONT "Geneva", 10 ;
		STYLE "B"
	@ 1.231,3.000 SAY "Printer Setup:" ;
		FONT "Geneva", 10 ;
		STYLE "B"
	@ 3.231,18.000 GET pdest ;
		PICTURE "@^3 File;PRN;LPT1;LPT2;LPT3;COM1;COM2;COM3" ;
		SIZE 1.462,19.833 ;
		DEFAULT "LPT1" ;
		FONT "Geneva", 10 ;
		VALID _qpr0ty1to()
	@ 5.923,4.000 GET flist ;
		PICTURE "@*HN3 \<File..." ;
		SIZE 1.538,11.000,1.000 ;
		DEFAULT 1 ;
		FONT "Geneva", 10 ;
		STYLE "B" ;
		VALID _qpr0ty1yn()
	@ 8.231,4.833 GET pfilname ;
		SIZE 0.923,34.667 ;
		DEFAULT " " ;
		FONT "Geneva", 10 ;
		PICTURE "@3S67" ;
		VALID _qpr0ty23n()
	@ 10.846,4.000 GET prtstat ;
		PICTURE "@*RVN3 Print On;Print Off" ;
		SIZE 1.308,11.143,0.000 ;
		DEFAULT 2 ;
		FONT "Geneva", 10 ;
		STYLE "BT"
	@ 11.077,36.333 GET _LMARGIN ;
		SIZE 0.923,2.667 ;
		DEFAULT " " ;
		FONT "Geneva", 10 ;
		PICTURE "@3 999" ;
		VALID _qpr0ty26i()
	@ 12.538,36.333 GET _RMARGIN ;
		SIZE 0.923,2.667 ;
		DEFAULT " " ;
		FONT "Geneva", 10 ;
		PICTURE "@3 999" ;
		VALID _qpr0ty2az()
	@ 2.769,43.500 GET OKbut ;
		PICTURE "@*HT3 \!OK" ;
		SIZE 1.538,10.000,6.000 ;
		DEFAULT 1 ;
		FONT "Geneva", 10 ;
		STYLE "B"
	@ 5.538,43.500 GET CancBut ;
		PICTURE "@*HT3 \?Cancel" ;
		SIZE 1.538,10.000,1.000 ;
		DEFAULT 1 ;
		FONT "Geneva", 10 ;
		STYLE "B"
	@ 14.692,4.000 GET pdrivstup ;
		PICTURE "@*C3 Printer \<Driver Setup..." ;
		SIZE 1.308,24.000 ;
		DEFAULT 0 ;
		FONT "Geneva", 10 ;
		STYLE "BT" ;
		VALID _qpr0ty2f7() ;
		DISABLE
	@ 11.000,22.000 SAY "Left Margin:" ;
		FONT "Geneva", 10 ;
		STYLE "B"
	@ 12.462,22.000 SAY "Right Margin:" ;
		FONT "Geneva", 10 ;
		STYLE "B"
	
	IF NOT WVISIBLE("_qpr0ty1be")
		ACTIVATE WINDOW _qpr0ty1be
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *   MacintoshREAD contains clauses from SCREEN prtsetup   
	*       *                                                         
	*       *********************************************************
	*
	
	READ CYCLE ;
		DEACTIVATE _qpr0ty2me() ;
		SHOW _qpr0ty2mi() ;
		MODAL
	
	RELEASE WINDOW _qpr0ty1be
	
	#REGION 0
	
	SET READBORDER &rborder
	
	IF m.talkstat = "ON"
		SET TALK ON
	ENDIF
	IF m.compstat = "ON"
		SET COMPATIBLE ON
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *             PRTSETUP/Macintosh Cleanup Code             
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	DO CASE
	CASE okbut = 1
	   SET PRINTER TO
	
	   IF prtstat = 1
	      SET PRINT ON
	   ELSE
	      SET PRINT OFF
	   ENDIF
	
	   pdest = ALLTRIM(UPPER(pdest))
	   DO CASE
	   CASE pdest = 'FILE'
	      IF !EMPTY(pfilname)
	         SET PRINTER TO (pfilname)
	      ELSE
	         SET PRINTER TO
	      ENDIF
	   OTHERWISE
	      pfilname = ''
	      SET PRINTER TO &pdest
	   ENDCASE
	CASE cancbut = 1
	   IF origprtstat = 1
	      SET PRINT ON
	   ELSE
	      SET PRINT OFF
	   ENDIF
	   pdest = origdest
	   pfilname = prt_infile
	ENDCASE
	skipvar = .F.
	

CASE _WINDOWS

	
	#REGION 0
	REGIONAL m.currarea, m.talkstat, m.compstat
	
	IF SET("TALK") = "ON"
		SET TALK OFF
		m.talkstat = "ON"
	ELSE
		m.talkstat = "OFF"
	ENDIF
	m.compstat = SET("COMPATIBLE")
	SET COMPATIBLE FOXPLUS
	
	m.rborder = SET("READBORDER")
	SET READBORDER ON
	
	*       *********************************************************
	*       *                                                         
	*       *               Windows Window definitions                
	*       *                                                         
	*       *********************************************************
	*
	
	IF NOT WEXIST("_qpr0ty3ad")
		DEFINE WINDOW _qpr0ty3ad ;
			AT  0.000, 0.000  ;
			SIZE 17.000,65.167 ;
			TITLE " Destino de impresión " ;
			FONT "MS Sans Serif", 8 ;
			STYLE "B" ;
			FLOAT ;
			NOCLOSE ;
			SHADOW ;
			NOMINIMIZE ;
			DOUBLE ;
			COLOR RGB(,,,192,192,192)
		MOVE WINDOW _qpr0ty3ad CENTER
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *         PRTSETUP/Windows Setup Code - SECTION 2         
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	
	skipvar = .T.
	pfilname = SPACE(67)
	
	pdest = SET('PRINTER',1)
	IF ":" $ pdest
	   pdest = LEFT(pdest,AT(':',pdest)-1)
	ENDIF
	IF !INLIST(pdest,'PRN','LPT1','LPT2','LPT3','COM1','COM2','COM3')
	   pfilname = PADR(pdest,67)
	   pdest = 'Archivo'
	ENDIF
	origdest = pdest
	prt_infile =pfilname
	
	IF SET('PRINT') = 'ON'
	   prtstat = 1
	ELSE
	   prtstat = 2
	ENDIF
	origprtstat = prtstat
	
	pdrivstup = IIF(LEN(_PDRIVER)=0,0,1)
	
	
	*       *********************************************************
	*       *                                                         
	*       *             PRTSETUP/Windows Screen Layout              
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	IF WVISIBLE("_qpr0ty3ad")
		ACTIVATE WINDOW _qpr0ty3ad SAME
	ELSE
		ACTIVATE WINDOW _qpr0ty3ad NOSHOW
	ENDIF
	@ 2.462,2.500 TO 16.000,49.667 ;
		PEN 1, 8
	@ 3.462,8.667 SAY "Imprimir en:" ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B"
	@ 1.000,3.000 SAY "Configurar impresión:" ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B"
	@ 3.231,21.000 GET pdest ;
		PICTURE "@^ File;PRN;LPT1;LPT2;LPT3;COM1;COM2;COM3" ;
		SIZE 1.538,19.800 ;
		DEFAULT "LPT1" ;
		FONT "MS Sans Serif", 8 ;
		VALID _qpr0ty3nz()
	@ 5.231,4.000 GET flist ;
		PICTURE "@*HN A\<rchivo..." ;
		SIZE 1.923,11.000,1.000 ;
		DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B" ;
		VALID _qpr0ty3ss()
	@ 7.692,4.333 GET pfilname ;
		SIZE 1.000,34.500 ;
		DEFAULT " " ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B" ;
		PICTURE "@3S67" ;
		VALID _qpr0ty3xw()
	@ 10.538,4.000 GET prtstat ;
		PICTURE "@*RVN Impresora activa;Impresora inactiva" ;
		SIZE 1.308,21.833,0.000 ;
		DEFAULT 2 ;
		FONT "MS Sans Serif", 8 ;
		STYLE "BT" ;
		COLOR ,,,,,,,,RGB(,,,192,192,192),RGB(,,,192,192,192)
	@ 10.769,43.833 GET _LMARGIN ;
		SIZE 1.000,2.667 ;
		DEFAULT " " ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B" ;
		PICTURE "@3 999" ;
		VALID _qpr0ty412()
	@ 12.154,43.833 GET _RMARGIN ;
		SIZE 1.000,2.667 ;
		DEFAULT " " ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B" ;
		PICTURE "@3 999" ;
		VALID _qpr0ty4e6()
	@ 2.538,52.500 GET OKbut ;
		PICTURE "@*HT \!Aceptar" ;
		SIZE 1.923,10.000,6.000 ;
		DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B"
	@ 4.846,52.500 GET CancBut ;
		PICTURE "@*HT \?Cancelar" ;
		SIZE 1.923,10.000,1.000 ;
		DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B"
	@ 14.231,4.000 GET pdrivstup ;
		PICTURE "@*C Configurar controlador de impresora" ;
		SIZE 1.308,38.167 ;
		DEFAULT 0 ;
		FONT "MS Sans Serif", 8 ;
		STYLE "BT" ;
		VALID _qpr0ty4gv() ;
		DISABLE
	@ 10.692,25.500 SAY "Margen izquierdo:" ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B"
	@ 12.077,25.500 SAY "Margen derecho:" ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B"
	
	IF NOT WVISIBLE("_qpr0ty3ad")
		ACTIVATE WINDOW _qpr0ty3ad
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *    WindowsREAD contains clauses from SCREEN prtsetup    
	*       *                                                         
	*       *********************************************************
	*
	
	READ CYCLE ;
		DEACTIVATE _qpr0ty4oh() ;
		SHOW _qpr0ty4om() ;
		MODAL
	
	RELEASE WINDOW _qpr0ty3ad
	
	#REGION 0
	
	SET READBORDER &rborder
	
	IF m.talkstat = "ON"
		SET TALK ON
	ENDIF
	IF m.compstat = "ON"
		SET COMPATIBLE ON
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *              PRTSETUP/Windows Cleanup Code              
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	DO CASE
	CASE okbut = 1
	   SET PRINTER TO
	
	   IF prtstat = 1
	      SET PRINT ON
	   ELSE
	      SET PRINT OFF
	   ENDIF
	
	   pdest = ALLTRIM(UPPER(pdest))
	   DO CASE
	   CASE pdest = 'ARCHIVO'
	      IF !EMPTY(pfilname)
	         SET PRINTER TO (pfilname)
	      ELSE
	         SET PRINTER TO
	      ENDIF
	   OTHERWISE
	      pfilname = ''
	      SET PRINTER TO &pdest
	   ENDCASE
	CASE cancbut = 1
	   IF origprtstat = 1
	      SET PRINT ON
	   ELSE
	      SET PRINT OFF
	   ENDIF
	   pdest = origdest
	   pfilname = prt_infile
	ENDCASE
	skipvar = .F.
	

ENDCASE


*       *********************************************************
*       *                                                         
*       * _QPR0TY00P           pdest VALID                        
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       MS-DOS                             
*       * From Screen:         PRTSETUP,     Record Number:    3  
*       * Variable:            pdest                              
*       * Called By:           VALID Clause                       
*       * Object Type:         Popup                              
*       * Snippet Number:      1                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty00p     &&  pdest VALID
#REGION 1
IF UPPER(pdest) = 'ARCHIVO'
   _CUROBJ = 3
ENDIF
SHOW GETS


*       *********************************************************
*       *                                                         
*       * _QPR0TY05I           flist VALID                        
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       MS-DOS                             
*       * From Screen:         PRTSETUP,     Record Number:    4  
*       * Variable:            flist                              
*       * Called By:           VALID Clause                       
*       * Object Type:         Push Button                        
*       * Snippet Number:      2                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty05i     &&  flist VALID
#REGION 1
IF flist = 1
   origfile = pfilname
   pfilname = GETFILE('','Imprimir en:')
   IF EMPTY(pfilname)
      pfilname = origfile
   ENDIF
ENDIF
pfilname = UPPER(PADR(pfilname,67))
IF !EMPTY(pfilname)
   pdest = 'Archivo'
ENDIF
SHOW GETS


*       *********************************************************
*       *                                                         
*       * _QPR0TY0C4           pfilname VALID                     
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       MS-DOS                             
*       * From Screen:         PRTSETUP,     Record Number:    5  
*       * Variable:            pfilname                           
*       * Called By:           VALID Clause                       
*       * Object Type:         Field                              
*       * Snippet Number:      3                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty0c4     &&  pfilname VALID
#REGION 1
pfilname = PADR(UPPER(LTRIM(pfilname)),67)
IF !EMPTY(pfilname)
   pdest = 'Archivo'
ENDIF
SHOW GETS


*       *********************************************************
*       *                                                         
*       * _QPR0TY0D6           _LMARGIN VALID                     
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       MS-DOS                             
*       * From Screen:         PRTSETUP,     Record Number:    7  
*       * Variable:            _LMARGIN                           
*       * Called By:           VALID Clause                       
*       * Object Type:         Field                              
*       * Snippet Number:      4                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty0d6     &&  _LMARGIN VALID
#REGION 1
_LMARGIN = MAX(0,_LMARGIN)
SHOW GETS


*       *********************************************************
*       *                                                         
*       * _QPR0TY0HP           _RMARGIN VALID                     
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       MS-DOS                             
*       * From Screen:         PRTSETUP,     Record Number:    8  
*       * Variable:            _RMARGIN                           
*       * Called By:           VALID Clause                       
*       * Object Type:         Field                              
*       * Snippet Number:      5                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty0hp     &&  _RMARGIN VALID
#REGION 1
_RMARGIN = MIN(_RMARGIN,255)
SHOW GETS


*       *********************************************************
*       *                                                         
*       * _QPR0TY0MX           pdrivstup VALID                    
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       MS-DOS                             
*       * From Screen:         PRTSETUP,     Record Number:   11  
*       * Variable:            pdrivstup                          
*       * Called By:           VALID Clause                       
*       * Object Type:         Check Box                          
*       * Snippet Number:      6                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty0mx     &&  pdrivstup VALID
#REGION 1
DO (_GENPD) WITH 1,"?"
IF LEN(_PDSETUP) = 0
   pdrivstup = 0
ELSE
   pdrivstup = 1
ENDIF
SHOW GET pdrivstup


*       *********************************************************
*       *                                                         
*       * _QPR0TY0SN           Read Level Deactivate              
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       *                                                         
*       * From Platform:       MS-DOS                             
*       * From Screen:         PRTSETUP                           
*       * Called By:           READ Statement                     
*       * Snippet Number:      7                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty0sn     && Read Level Deactivate
*
* Deactivate Code from screen: PRTSETUP
*
#REGION 1
?? CHR(7)
RETURN .F.


*       *********************************************************
*       *                                                         
*       * _QPR0TY0SR           Read Level Show                    
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       *                                                         
*       * From Platform:       MS-DOS                             
*       * From Screen:         PRTSETUP                           
*       * Called By:           READ Statement                     
*       * Snippet Number:      8                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty0sr     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: PRTSETUP
*
#REGION 1
IF UPPER(pdest) = 'ARCHIVO'
   SHOW GET pfilname ENABLE
   IF EMPTY(pfilname)
      SHOW GET okbut DISABLE
   ELSE
      SHOW GET okbut ENABLE
   ENDIF
ELSE
   SHOW GET pfilname DISABLE
   SHOW GET okbut ENABLE
ENDIF

IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF

*       *********************************************************
*       *                                                         
*       * _QPR0TY1TO           pdest VALID                        
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Macintosh                          
*       * From Screen:         PRTSETUP,     Record Number:   37  
*       * Variable:            pdest                              
*       * Called By:           VALID Clause                       
*       * Object Type:         Popup                              
*       * Snippet Number:      9                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty1to     &&  pdest VALID
#REGION 1
IF UPPER(pdest) = 'FILE'
   _CUROBJ = 3
ENDIF
SHOW GETS


*       *********************************************************
*       *                                                         
*       * _QPR0TY1YN           flist VALID                        
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Macintosh                          
*       * From Screen:         PRTSETUP,     Record Number:   38  
*       * Variable:            flist                              
*       * Called By:           VALID Clause                       
*       * Object Type:         Push Button                        
*       * Snippet Number:      10                                 
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty1yn     &&  flist VALID
#REGION 1
IF flist = 1
   origfile = pfilname
   pfilname = GETFILE('','Print to:')
   IF EMPTY(pfilname)
      pfilname = origfile
   ENDIF
ENDIF
pfilname = UPPER(PADR(pfilname,67))
IF !EMPTY(pfilname)
   pdest = 'File'
ENDIF
SHOW GETS


*       *********************************************************
*       *                                                         
*       * _QPR0TY23N           pfilname VALID                     
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Macintosh                          
*       * From Screen:         PRTSETUP,     Record Number:   39  
*       * Variable:            pfilname                           
*       * Called By:           VALID Clause                       
*       * Object Type:         Field                              
*       * Snippet Number:      11                                 
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty23n     &&  pfilname VALID
#REGION 1
pfilname = PADR(UPPER(LTRIM(pfilname)),67)
IF !EMPTY(pfilname)
   pdest = 'File'
ENDIF
SHOW GETS


*       *********************************************************
*       *                                                         
*       * _QPR0TY26I           _LMARGIN VALID                     
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Macintosh                          
*       * From Screen:         PRTSETUP,     Record Number:   41  
*       * Variable:            _LMARGIN                           
*       * Called By:           VALID Clause                       
*       * Object Type:         Field                              
*       * Snippet Number:      12                                 
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty26i     &&  _LMARGIN VALID
#REGION 1
_LMARGIN = MAX(0,_LMARGIN)
SHOW GETS


*       *********************************************************
*       *                                                         
*       * _QPR0TY2AZ           _RMARGIN VALID                     
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Macintosh                          
*       * From Screen:         PRTSETUP,     Record Number:   42  
*       * Variable:            _RMARGIN                           
*       * Called By:           VALID Clause                       
*       * Object Type:         Field                              
*       * Snippet Number:      13                                 
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty2az     &&  _RMARGIN VALID
#REGION 1
_RMARGIN = MIN(_RMARGIN,255)
SHOW GETS


*       *********************************************************
*       *                                                         
*       * _QPR0TY2F7           pdrivstup VALID                    
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Macintosh                          
*       * From Screen:         PRTSETUP,     Record Number:   45  
*       * Variable:            pdrivstup                          
*       * Called By:           VALID Clause                       
*       * Object Type:         Check Box                          
*       * Snippet Number:      14                                 
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty2f7     &&  pdrivstup VALID
#REGION 1
DO (_GENPD) WITH 1,"?"
IF LEN(_PDSETUP) = 0
   pdrivstup = 0
ELSE
   pdrivstup = 1
ENDIF
SHOW GET pdrivstup


*       *********************************************************
*       *                                                         
*       * _QPR0TY2ME           Read Level Deactivate              
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       *                                                         
*       * From Platform:       Macintosh                          
*       * From Screen:         PRTSETUP                           
*       * Called By:           READ Statement                     
*       * Snippet Number:      15                                 
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty2me     && Read Level Deactivate
*
* Deactivate Code from screen: PRTSETUP
*
#REGION 1
?? CHR(7)
RETURN .F.


*       *********************************************************
*       *                                                         
*       * _QPR0TY2MI           Read Level Show                    
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       *                                                         
*       * From Platform:       Macintosh                          
*       * From Screen:         PRTSETUP                           
*       * Called By:           READ Statement                     
*       * Snippet Number:      16                                 
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty2mi     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: PRTSETUP
*
#REGION 1
IF UPPER(pdest) = 'FILE'
   SHOW GET pfilname ENABLE
   IF EMPTY(pfilname)
      SHOW GET okbut DISABLE
   ELSE
      SHOW GET okbut ENABLE
   ENDIF
ELSE
   SHOW GET pfilname DISABLE
   SHOW GET okbut ENABLE
ENDIF

IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF

*       *********************************************************
*       *                                                         
*       * _QPR0TY3NZ           pdest VALID                        
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         PRTSETUP,     Record Number:   20  
*       * Variable:            pdest                              
*       * Called By:           VALID Clause                       
*       * Object Type:         Popup                              
*       * Snippet Number:      17                                 
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty3nz     &&  pdest VALID
#REGION 1
IF UPPER(pdest) = 'ARCHIVO'
   _CUROBJ = 3
ENDIF
SHOW GETS


*       *********************************************************
*       *                                                         
*       * _QPR0TY3SS           flist VALID                        
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         PRTSETUP,     Record Number:   21  
*       * Variable:            flist                              
*       * Called By:           VALID Clause                       
*       * Object Type:         Push Button                        
*       * Snippet Number:      18                                 
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty3ss     &&  flist VALID
#REGION 1
IF flist = 1
   origfile = pfilname
   pfilname = GETFILE('','Imprimir en:')
   IF EMPTY(pfilname)
      pfilname = origfile
   ENDIF
ENDIF
pfilname = UPPER(PADR(pfilname,67))
IF !EMPTY(pfilname)
   pdest = 'Archivo'
ENDIF
SHOW GETS


*       *********************************************************
*       *                                                         
*       * _QPR0TY3XW           pfilname VALID                     
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         PRTSETUP,     Record Number:   22  
*       * Variable:            pfilname                           
*       * Called By:           VALID Clause                       
*       * Object Type:         Field                              
*       * Snippet Number:      19                                 
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty3xw     &&  pfilname VALID
#REGION 1
pfilname = PADR(UPPER(LTRIM(pfilname)),67)
IF !EMPTY(pfilname)
   pdest = 'Archivo'
ENDIF
SHOW GETS


*       *********************************************************
*       *                                                         
*       * _QPR0TY412           _LMARGIN VALID                     
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         PRTSETUP,     Record Number:   24  
*       * Variable:            _LMARGIN                           
*       * Called By:           VALID Clause                       
*       * Object Type:         Field                              
*       * Snippet Number:      20                                 
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty412     &&  _LMARGIN VALID
#REGION 1
_LMARGIN = MAX(0,_LMARGIN)
SHOW GETS


*       *********************************************************
*       *                                                         
*       * _QPR0TY4E6           _RMARGIN VALID                     
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         PRTSETUP,     Record Number:   25  
*       * Variable:            _RMARGIN                           
*       * Called By:           VALID Clause                       
*       * Object Type:         Field                              
*       * Snippet Number:      21                                 
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty4e6     &&  _RMARGIN VALID
#REGION 1
_RMARGIN = MIN(_RMARGIN,255)
SHOW GETS


*       *********************************************************
*       *                                                         
*       * _QPR0TY4GV           pdrivstup VALID                    
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         PRTSETUP,     Record Number:   28  
*       * Variable:            pdrivstup                          
*       * Called By:           VALID Clause                       
*       * Object Type:         Check Box                          
*       * Snippet Number:      22                                 
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty4gv     &&  pdrivstup VALID
#REGION 1
DO (_GENPD) WITH 1,"?"
IF LEN(_PDSETUP) = 0
   pdrivstup = 0
ELSE
   pdrivstup = 1
ENDIF
SHOW GET pdrivstup


*       *********************************************************
*       *                                                         
*       * _QPR0TY4OH           Read Level Deactivate              
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         PRTSETUP                           
*       * Called By:           READ Statement                     
*       * Snippet Number:      23                                 
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty4oh     && Read Level Deactivate
*
* Deactivate Code from screen: PRTSETUP
*
#REGION 1
?? CHR(7)
RETURN .F.


*       *********************************************************
*       *                                                         
*       * _QPR0TY4OM           Read Level Show                    
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         PRTSETUP                           
*       * Called By:           READ Statement                     
*       * Snippet Number:      24                                 
*       *                                                         
*       *********************************************************
*
FUNCTION _qpr0ty4om     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: PRTSETUP
*
#REGION 1
IF UPPER(pdest) = 'FILE'
   SHOW GET pfilname ENABLE
   IF EMPTY(pfilname)
      SHOW GET okbut DISABLE
   ELSE
      SHOW GET okbut ENABLE
   ENDIF
ELSE
   SHOW GET pfilname DISABLE
   SHOW GET okbut ENABLE
ENDIF

IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF


*       *********************************************************
*       *                                                         
*       *  PRTSETUP/Windows Supporting Procedures and Functions   
*       *                                                         
*       *********************************************************
*

#REGION 1